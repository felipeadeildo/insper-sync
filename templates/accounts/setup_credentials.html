{% extends 'base.html' %}

{% block title %}Configurar Credenciais - Insper Sync{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-primary/5 to-secondary/5 py-8">
  <div class="container mx-auto px-4">
    <!-- Breadcrumb -->
    <div class="breadcrumbs text-sm mb-6 max-w-4xl mx-auto">
      <ul>
        <li><a href="{% url 'dashboard' %}" class="link link-hover">Dashboard</a></li>
        <li class="text-base-content/60">Configurar Credenciais</li>
      </ul>
    </div>

    <!-- Hero Section -->
    <div class="text-center mb-12 max-w-3xl mx-auto">
      <div class="w-16 h-16 bg-primary/20 text-primary rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg">
        <i data-lucide="key" class="w-8 h-8"></i>
      </div>
      <h1 class="text-3xl lg:text-4xl font-bold text-primary mb-4">
        Configurar Credenciais
      </h1>
      <p class="text-lg text-base-content/70">
        Conecte-se ao Portal do Insper para sincronizar seus calendários de forma segura
      </p>
    </div>

    <!-- Main Content -->
    <div class="max-w-2xl mx-auto">
      <!-- Form Card -->
      <div class="card bg-base-100 shadow-2xl border border-base-300/50">
        <div class="card-body p-8">
          
          <!-- Progress Indicator -->
          <div class="mb-8">
            <div class="flex items-center justify-between text-sm mb-2">
              <span class="text-base-content/60">Passo 2 de 3</span>
              <span class="text-base-content/60">Credenciais</span>
            </div>
            <progress class="progress progress-primary w-full" value="66" max="100"></progress>
          </div>

          <form method="post" class="space-y-6">
            {% csrf_token %}

            <!-- Username Field -->
            <div class="form-control">
              <label class="label">
                <span class="label-text font-semibold text-base flex items-center gap-2">
                  <i data-lucide="user" class="w-4 h-4 text-primary"></i>
                  Usuário do Portal Insper
                </span>
              </label>
              <input
                type="text"
                name="insper_username"
                placeholder="Ex: joão.silva"
                class="input input-bordered input-lg w-full focus:input-primary transition-all duration-200"
                required
                value="{{ insper_username|default:'' }}"
              />
              <label class="label">
                <span class="label-text-alt text-base-content/60 flex items-center gap-1">
                  <i data-lucide="info" class="w-3 h-3"></i>
                  Seu nome de usuário (sem @al.insper.edu.br)
                </span>
              </label>
            </div>

            <!-- Password Field -->
            <div class="form-control">
              <label class="label">
                <span class="label-text font-semibold text-base flex items-center gap-2">
                  <i data-lucide="lock" class="w-4 h-4 text-primary"></i>
                  Senha do Portal Insper
                </span>
              </label>
              <div class="relative">
                <input
                  type="password"
                  name="insper_password"
                  id="password"
                  placeholder="••••••••"
                  class="input input-bordered input-lg w-full pr-12 focus:input-primary transition-all duration-200"
                  required
                />
                <button
                  type="button"
                  class="absolute right-3 top-1/2 -translate-y-1/2 text-base-content/50 hover:text-base-content"
                  onclick="togglePassword()"
                >
                  <i data-lucide="eye" id="eye-icon" class="w-5 h-5"></i>
                </button>
              </div>
              <label class="label">
                <span class="label-text-alt text-base-content/60 flex items-center gap-1">
                  <i data-lucide="info" class="w-3 h-3"></i>
                  A mesma senha que você usa no portal acadêmico
                </span>
              </label>
            </div>

            <!-- Security Notice -->
            <div class="bg-info/10 border border-info/20 rounded-lg p-6">
              <div class="flex items-start gap-4">
                <div class="w-10 h-10 bg-info/20 text-info rounded-full flex items-center justify-center flex-shrink-0">
                  <i data-lucide="shield-check" class="w-5 h-5"></i>
                </div>
                <div>
                  <h3 class="font-semibold text-info mb-2">Suas credenciais estão protegidas</h3>
                  <div class="text-sm text-base-content/80 space-y-2">
                    <p>Utilizamos criptografia de ponta com a chave pública oficial do Insper para manter suas informações seguras.</p>
                    <div class="flex items-center gap-2 text-xs">
                      <i data-lucide="check" class="w-3 h-3 text-success"></i>
                      <span>Criptografia RSA com chave pública</span>
                    </div>
                    <div class="flex items-center gap-2 text-xs">
                      <i data-lucide="check" class="w-3 h-3 text-success"></i>
                      <span>Nem nossa equipe pode ver sua senha</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Submit Button -->
            <button type="submit" class="btn btn-primary btn-lg w-full">
              <i data-lucide="arrow-right" class="w-5 h-5"></i>
              Salvar e Continuar
            </button>
          </form>
        </div>
      </div>

      <!-- Help Section -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-8">
        <!-- Help Card -->
        <div class="card bg-base-100/50 backdrop-blur-sm border border-base-300/50 shadow-sm">
          <div class="card-body p-6">
            <h3 class="font-semibold flex items-center gap-2 text-base mb-4">
              <div class="w-8 h-8 bg-info/20 text-info rounded-full flex items-center justify-center">
                <i data-lucide="help-circle" class="w-4 h-4"></i>
              </div>
              Como encontrar?
            </h3>
            <div class="space-y-3 text-sm text-base-content/70">
              <div class="flex items-start gap-2">
                <i data-lucide="user" class="w-4 h-4 mt-0.5 text-primary flex-shrink-0"></i>
                <span>Use suas credenciais do Portal Acadêmico do Insper</span>
              </div>
              <div class="flex items-start gap-2">
                <i data-lucide="at-sign" class="w-4 h-4 mt-0.5 text-primary flex-shrink-0"></i>
                <span>Usuário: geralmente seu nome.sobrenome (sem @al.insper.edu.br)</span>
              </div>
              <div class="flex items-start gap-2">
                <i data-lucide="key" class="w-4 h-4 mt-0.5 text-primary flex-shrink-0"></i>
                <span>Senha: a mesma do portal acadêmico</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Support Card -->
        <div class="card bg-base-100/50 backdrop-blur-sm border border-base-300/50 shadow-sm">
          <div class="card-body p-6">
            <h3 class="font-semibold flex items-center gap-2 text-base mb-4">
              <div class="w-8 h-8 bg-warning/20 text-warning rounded-full flex items-center justify-center">
                <i data-lucide="headphones" class="w-4 h-4"></i>
              </div>
              Precisa de ajuda?
            </h3>
            <div class="space-y-3 text-sm text-base-content/70">
              <p>Se você não consegue acessar o Portal Acadêmico ou esqueceu suas credenciais:</p>
              <div class="flex items-start gap-2">
                <i data-lucide="phone" class="w-4 h-4 mt-0.5 text-warning flex-shrink-0"></i>
                <span>Entre em contato com o Suporte TI do Insper</span>
              </div>
              <div class="flex items-start gap-2">
                <i data-lucide="external-link" class="w-4 h-4 mt-0.5 text-warning flex-shrink-0"></i>
                <span>Acesse o portal para testar suas credenciais primeiro</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Step Navigation -->
      <div class="flex items-center justify-between mt-12 p-6 bg-base-100/50 backdrop-blur-sm rounded-lg border border-base-300/50">
        <div class="text-sm text-base-content/60">
          <i data-lucide="arrow-left" class="w-4 h-4 inline mr-1"></i>
          Anterior: Verificação de email
        </div>
        <div class="text-sm text-base-content/60">
          Próximo: Conectar Google Calendar
          <i data-lucide="arrow-right" class="w-4 h-4 inline ml-1"></i>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  function togglePassword() {
    const passwordInput = document.getElementById('password');
    const eyeIcon = document.getElementById('eye-icon');
    
    if (passwordInput.type === 'password') {
      passwordInput.type = 'text';
      eyeIcon.setAttribute('data-lucide', 'eye-off');
    } else {
      passwordInput.type = 'password';
      eyeIcon.setAttribute('data-lucide', 'eye');
    }
    
    lucide.createIcons();
  }

  // Initialize Lucide icons on load
  document.addEventListener('DOMContentLoaded', function() {
    lucide.createIcons();
  });
</script>
{% endblock %}