<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Sincronize seu calend√°rio do Insper com Google Calendar de forma autom√°tica"
    />

    <!-- daisyUI + Tailwind CSS via CDN -->
    <link
      href="https://cdn.jsdelivr.net/npm/daisyui@5"
      rel="stylesheet"
      type="text/css"
    />
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Favicon -->
    <link
      rel="icon"
      type="image/svg+xml"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìÖ</text></svg>"
    />

    <title>
      {% block title %}Insper Sync - Sincroniza√ß√£o de Calend√°rio{% endblock %}
    </title>

    {% block extra_head %}{% endblock %}
  </head>
  <body class="min-h-screen bg-base-100">
    <!-- Navbar -->
    <div class="navbar bg-base-200 shadow-lg">
      <div class="navbar-start">
        <a href="/" class="btn btn-ghost text-xl">
          <span class="text-2xl">üìÖ</span>
          <span class="font-bold text-primary">Insper Sync</span>
        </a>
      </div>

      <div class="navbar-center hidden lg:flex">
        <ul class="menu menu-horizontal px-1">
          <li><a href="/" class="hover:text-primary">In√≠cio</a></li>
          <li><a href="#sobre" class="hover:text-primary">Como Funciona</a></li>
          <li><a href="#contato" class="hover:text-primary">Suporte</a></li>
        </ul>
      </div>

      <div class="navbar-end">
        <!-- Theme Toggle -->
        <label class="swap swap-rotate mr-4">
          <input type="checkbox" class="theme-controller" value="dark" />
          <i data-lucide="sun" class="swap-off w-6 h-6"></i>
          <i data-lucide="moon" class="swap-on w-6 h-6"></i>
        </label>

        <!-- Mobile menu -->
        <div class="dropdown dropdown-end lg:hidden">
          <div tabindex="0" role="button" class="btn btn-ghost">
            <i data-lucide="menu" class="w-5 h-5"></i>
          </div>
          <ul
            tabindex="0"
            class="menu menu-sm dropdown-content mt-3 z-50 p-2 shadow bg-base-100 rounded-box w-52"
          >
            <li><a href="/">In√≠cio</a></li>
            <li><a href="#sobre">Como Funciona</a></li>
            <li><a href="#contato">Suporte</a></li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <main class="min-h-[calc(100vh-4rem)]">
      {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="footer footer-center p-10 bg-base-200 text-base-content">
      <nav class="grid grid-flow-col gap-4">
        <a href="#sobre" class="link link-hover">Como Funciona</a>
        <a href="#privacidade" class="link link-hover">Privacidade</a>
        <a href="#termos" class="link link-hover">Termos de Uso</a>
        <a href="#contato" class="link link-hover">Suporte</a>
      </nav>
      <nav>
        <div class="grid grid-flow-col gap-4">
          <a
            href="https://github.com"
            class="link link-hover"
            aria-label="GitHub"
          >
            <i data-lucide="github" class="w-6 h-6"></i>
          </a>
          <a
            href="mailto:suporte@insper-sync.dev"
            class="link link-hover"
            aria-label="Email"
          >
            <i data-lucide="mail" class="w-6 h-6"></i>
          </a>
        </div>
      </nav>
      <aside>
        <p class="text-sm">
          ¬© 2025 Insper Sync. Feito com ‚ù§Ô∏è para estudantes do Insper.
          <br />
          <span class="text-xs opacity-70">
            N√£o somos afiliados ao Insper. Este √© um projeto independente.
          </span>
        </p>
      </aside>
    </footer>

    <!-- Toast Container for notifications -->
    <div class="toast toast-top toast-end z-50">
      {% if messages %} {% for message in messages %}
      <div class="alert alert-{{ message.tags|default:'info' }}">
        <span>{{ message }}</span>
      </div>
      {% endfor %} {% endif %}
    </div>

    {% block extra_js %}{% endblock %}

    <script>
      // Initialize Lucide icons
      lucide.createIcons()

      // Theme persistence management
      const themeController = document.querySelector('.theme-controller')
      const htmlElement = document.documentElement

      // Function to apply theme
      function applyTheme(theme) {
        htmlElement.setAttribute('data-theme', theme)
        if (themeController) {
          themeController.checked = theme === 'dark'
        }
      }

      // Load saved theme on page load
      document.addEventListener('DOMContentLoaded', function() {
        const savedTheme = localStorage.getItem('insper-sync-theme')

        if (savedTheme) {
          // Use saved theme
          applyTheme(savedTheme)
        } else {
          // Check system preference
          const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches
          const defaultTheme = prefersDark ? 'dark' : 'light'
          applyTheme(defaultTheme)
          localStorage.setItem('insper-sync-theme', defaultTheme)
        }
      })

      // Listen for theme changes
      if (themeController) {
        themeController.addEventListener('change', function() {
          const newTheme = this.checked ? 'dark' : 'light'
          applyTheme(newTheme)
          localStorage.setItem('insper-sync-theme', newTheme)
        })
      }

      // Listen for system theme changes
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
        // Only auto-switch if user hasn't manually set a preference
        const savedTheme = localStorage.getItem('insper-sync-theme')
        if (!savedTheme) {
          const systemTheme = e.matches ? 'dark' : 'light'
          applyTheme(systemTheme)
          localStorage.setItem('insper-sync-theme', systemTheme)
        }
      })

      // Smooth scrolling for anchor links
      document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
        anchor.addEventListener('click', function (e) {
          e.preventDefault()
          const target = document.querySelector(this.getAttribute('href'))
          if (target) {
            target.scrollIntoView({
              behavior: 'smooth',
              block: 'start',
            })
          }
        })
      })

      // Auto-hide alerts after 5 seconds
      setTimeout(() => {
        const alerts = document.querySelectorAll('.alert')
        alerts.forEach((alert) => {
          alert.style.transition = 'opacity 0.5s'
          alert.style.opacity = '0'
          setTimeout(() => alert.remove(), 500)
        })
      }, 5000)
    </script>
  </body>
</html>
